<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DmlAnonChat</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="stylesheet" href="style.css" />
  <script defer src="/socket.io/socket.io.js"></script>
  <script defer src="script.js"></script>
</head>

<body>
  <header>
    <h1>ğŸ’¬ DmlAnonChat</h1>
    <button id="toggle-dark">ğŸŒ™</button>
  </header>

  <main>
    <!-- Chat container -->
    <div class="chat-container">
      <div class="sidebar">
        <h3>Online Users</h3>
        <ul id="users"></ul>
      </div>

      <div class="chat-box">
        <div id="messages" class="messages"></div>
        <div id="typing" class="typing-indicator"></div>

        <div class="input-area">
          <input id="message" type="text" placeholder="Type your message..." autocomplete="off" />
          <button id="sendBtn">Send</button>
        </div>

        <div class="chat-controls">
          <button id="share-link-btn" class="hidden">ğŸ“¤ Share Room Link</button>
        </div>
      </div>
    </div>
  </main>

  <footer>
    <button id="install-btn" class="install-btn hidden">ğŸ“² Download DmlAnonChat</button>
    <p>Anonymous chatting made simple and secure ğŸ•¶ï¸</p>
  </footer>

  <script>
    // âœ… Dark Mode toggle
    const toggleDark = document.getElementById("toggle-dark");
    toggleDark.addEventListener("click", () => {
      document.body.classList.toggle("dark-mode");
      localStorage.setItem("darkMode", document.body.classList.contains("dark-mode"));
    });
    if (localStorage.getItem("darkMode") === "true") {
      document.body.classList.add("dark-mode");
    }

    // âœ… PWA Install button
    let deferredPrompt;
    const installBtn = document.getElementById("install-btn");

    window.addEventListener("beforeinstallprompt", (e) => {
      e.preventDefault();
      deferredPrompt = e;
      installBtn.classList.remove("hidden");
    });

    installBtn.addEventListener("click", async () => {
      installBtn.classList.add("hidden");
      if (deferredPrompt) {
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        if (outcome === "accepted") {
          console.log("App installed");
        }
        deferredPrompt = null;
      }
    });
  </script>
</body>
</html>
